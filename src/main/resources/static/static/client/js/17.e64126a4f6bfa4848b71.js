webpackJsonp([17],{WfkP:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("vLgD"),s=a("7biW"),l=a("RAp7"),n={props:["id"],mixins:[l.a],components:{"search-area":s.a},name:"lists",data:function(){return{searchData:[{type:"tel",show:!0,name:"手机号码"}],defTag:"tel",total:0,lists:[],pageSizes:[10,30,50,100],listQuery:{page:1,limit:10,offset:0,id:this.id,starttime:"",endtime:"",json:"[]"}}},created:function(){this.getList()},methods:{getList:function(t){var e=this;t&&(e.listQuery.page=1,e.listQuery.offset=0),e.listQuery.offset=(e.listQuery.page-1)*e.listQuery.limit,Object(i.a)("mms/sent/listSents",e.listQuery).then(function(t){e.lists=t.rows,e.total=t.total}).catch(function(){})}}},r={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"sent-list"},[a("div",{staticClass:"query c"},[a("search-area",{attrs:{search:t.searchData,defTag:t.defTag},on:{searchFun:t.searchFun}})],1),t._v(" "),a("el-table",{attrs:{data:t.lists}},[a("el-table-column",{attrs:{align:"center",label:"序号",type:"index",width:"80"}}),t._v(" "),a("el-table-column",{attrs:{label:"手机号码",prop:"phone"}}),t._v(" "),a("el-table-column",{attrs:{label:"发送时间",prop:"sendTime"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"提交状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[0==e.row.sendStatus?a("p",{staticClass:"td-btn"},[a("font",{staticClass:"point point-error"},[t._v("提交失败")])],1):t._e(),t._v(" "),1==e.row.sendStatus?a("p",{staticClass:"td-btn"},[a("font",{staticClass:"point point-success"},[t._v("提交成功")])],1):t._e(),t._v(" "),3==e.row.sendStatus?a("p",{staticClass:"td-btn"},[a("font",{staticClass:"point point-info"},[t._v("不提交")])],1):t._e()]}}])})],1),t._v(" "),a("div",{staticClass:"pagination-container"},[a("el-pagination",{attrs:{"current-page":t.listQuery.page,"page-size":t.listQuery.limit,"page-sizes":t.pageSizes,total:t.total,background:"",layout:"total, prev, pager, next, sizes, jumper"},on:{"current-change":t.handleCurrentChange,"size-change":t.handleSizeChange}})],1)],1)},staticRenderFns:[]},o=a("VU/8")(n,r,!1,null,null,null).exports,c=a("X2Oc"),d={name:"sentLists",mixins:[l.a],components:{"search-area":s.a,"sent-lists":o},data:function(){return{searchData:[{type:"title",show:!0,name:"彩信标题"},{type:"sendState",name:"提交状态",show:!0,value:[{name:"提交失败",value:0},{name:"提交成功",value:1},{name:"等待提交",value:2},{name:"不提交",value:3},{name:"提交中",value:4},{name:"部分失败",value:5},{name:"终止提交",value:6}]},{type:"state",name:"审核状态",show:!0,value:[{name:"审核拒绝",value:0},{name:"审核通过",value:1},{name:"等待审核",value:2},{name:"不审核",value:3}]}],defTag:"title",total:0,lists:[],pageSizes:[10,30,50,100],listQuery:{page:1,limit:10,offset:0,starttime:"",endtime:"",json:"[]",pdType:7,id:"",sendState:"",title:""},item:"",previewTitle:"",dialogPreview:!1,dialogSent:!1,id:""}},created:function(){this.getList()},methods:{opinion:function(t,e){var a=this;t&&a.R("原因："+t),e&&a.$nextTick(function(){a.R("备注："+e)})},cancel:function(t){var e=this;e.$confirm("您确定要取消发送吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(i.b)("mms/todo/cancel",{id:t}).then(function(t){e.getList()}).catch(function(){})}).catch(function(){})},sendRecord:function(t){this.id=t.id,this.dialogSent=!0},preview:function(t){var e=this;t?(e.item=Object(c.f)(JSON.parse(t.frameJson)),e.previewTitle=t.title):(e.item=e.frameJson,e.previewTitle=e.title),e.dialogPreview=!0,e.$nextTick(function(){$(".slide").scrollTop(0)})},getList:function(t){var e=this;t&&(e.listQuery.page=1,e.listQuery.offset=0),e.listQuery.offset=(e.listQuery.page-1)*e.listQuery.limit,Object(i.a)("mms/log/batch/list",e.listQuery).then(function(t){e.lists=t.rows,e.total=t.total}).catch(function(){})},reset:function(){this.listQuery.id="",this.listQuery.sendState="",this.listQuery.title="",this.resetTime(),this.getList()},resetTime:function(){var t=new Date,e=Object(c.e)(t,"yyyy/MM/dd"),a=new Date;a.setTime(a.getTime());var i=Object(c.e)(a,"yyyy/MM/dd")+" 00:00:00",s=e+" 23:59:59";this.listQuery.starttime=i,this.listQuery.endtime=s,this.datePickerVal=[new Date(i),new Date(s)]}}},u={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"pay-list bgw p2"},[a("div",{staticClass:"query"},[a("el-form",{attrs:{inline:!0,model:t.listQuery,size:"mini"}},[a("el-form-item",{attrs:{label:"任务ID"}},[a("el-input",{attrs:{placeholder:"任务ID"},model:{value:t.listQuery.id,callback:function(e){t.$set(t.listQuery,"id",e)},expression:"listQuery.id"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"下发状态"}},[a("el-select",{attrs:{placeholder:"下发状态"},model:{value:t.listQuery.sendState,callback:function(e){t.$set(t.listQuery,"sendState",e)},expression:"listQuery.sendState"}},[a("el-option",{attrs:{label:"全部",value:""}}),t._v(" "),a("el-option",{attrs:{label:"未激活",value:"0"}}),t._v(" "),a("el-option",{attrs:{label:"成功",value:"1"}}),t._v(" "),a("el-option",{attrs:{label:"处理中",value:"2"}})],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"标题"}},[a("el-input",{attrs:{placeholder:"标题"},model:{value:t.listQuery.title,callback:function(e){t.$set(t.listQuery,"title",e)},expression:"listQuery.title"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"提交时间"}},[a("el-date-picker",{attrs:{"popper-class":"veesing-date-picker",editable:!1,clearable:!1,type:"datetimerange",format:"yyyy/MM/dd HH:mm:ss","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd HH:mm:ss","default-time":["00:00:00","23:59:59"],"picker-options":t.pickerOptions},on:{change:function(e){return t.createTime()}},model:{value:t.datePickerVal,callback:function(e){t.datePickerVal=e},expression:"datePickerVal"}})],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:t.getList}},[t._v("查询")]),t._v(" "),a("el-button",{on:{click:t.reset}},[t._v("重置")])],1)],1)],1),t._v(" "),a("el-table",{attrs:{data:t.lists}},[a("el-table-column",{attrs:{align:"center",label:"任务ID",prop:"id",width:"100"}}),t._v(" "),a("el-table-column",{attrs:{label:"标题",prop:"title","show-overflow-tooltip":!0,"min-width":"170px"}}),t._v(" "),a("el-table-column",{attrs:{label:"号码数",align:"center",prop:"numbers",width:"80"}}),t._v(" "),a("el-table-column",{attrs:{label:"提交时间",prop:"createTime","min-width":"170"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"下发状态","min-width":"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[0==e.row.sendState?a("p",{staticClass:"td-btn"},[a("font",{staticClass:"point point-error"},[t._v("未激活")])],1):t._e(),t._v(" "),1==e.row.sendState||5==e.row.sendState?a("p",{staticClass:"td-btn"},[a("font",{staticClass:"point point-success"},[t._v("成功")])],1):t._e(),t._v(" "),2==e.row.sendState?a("p",{staticClass:"td-btn"},[a("font",{staticClass:"point point-warning"},[t._v("处理中")])],1):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"下发时间",prop:"submitTime","min-width":"170"}}),t._v(" "),a("el-table-column",{attrs:{label:"对接地址","min-width":"170"},scopedSlots:t._u([{key:"default",fn:function(e){return[1==e.row.isApi?a("span",[t._v("api："+t._s(e.row.ip))]):t._e(),t._v(" "),0!=e.row.isApi&&e.row.isApi?t._e():a("span",[t._v("client："+t._s(e.row.ip))])]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",fixed:"right",label:"操作",width:"130"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("p",{staticClass:"operating"},[a("a",{on:{click:function(a){return t.preview(e.row)}}},[t._v("预览")]),t._v(" "),0===e.row.state?a("a",{on:{click:function(a){return t.opinion(e.row.opnition,e.row.remark)}}},[t._v("查看原因")]):t._e(),t._v(" "),a("a",{attrs:{href:"/mms/log/batch/phone/export?id="+e.row.id,target:"_blank"}},[t._v("下载号码")]),t._v(" "),1===e.row.state?a("router-link",{attrs:{to:"/client/videomms/receipt?taskId="+e.row.id}},[t._v("查看回执")]):t._e()],1)]}}])})],1),t._v(" "),a("div",{staticClass:"pagination-container"},[a("el-pagination",{attrs:{"current-page":t.listQuery.page,"page-size":t.listQuery.limit,"page-sizes":t.pageSizes,total:t.total,background:"",layout:"total, prev, pager, next, sizes, jumper"},on:{"current-change":t.handleCurrentChange,"size-change":t.handleSizeChange}})],1),t._v(" "),a("transition",{attrs:{name:"dialog-fade"}},[t.dialogPreview?a("div",{staticClass:"dialog dialog-min"},[a("div",{staticClass:"dialog-body"},[a("div",{staticClass:"dialog-header"},[t._v("\n          预览 "),a("i",{staticClass:"fr iconfont iconsystem-cancel-bold",on:{click:function(e){t.dialogPreview=!1}}})]),t._v(" "),a("div",{staticClass:"dialog-content c p2"},[a("div",{staticClass:"mms-preview"},[a("div",{staticClass:"slide"},[a("div",{staticClass:"slide-item",staticStyle:{display:"inline-block"}},[a("p",[t._v(t._s(t.previewTitle))])]),t._v(" "),t._l(t.item,function(e,i){return a("div",{key:i,staticClass:"slide-item"},[e.photopath?a("img",{attrs:{src:e.photopath}}):t._e(),t._v(" "),e.videopath?a("video",{attrs:{src:e.videopath,controls:""}}):t._e(),t._v(" "),e.voicepath?a("audio",{attrs:{src:e.voicepath,controls:""}}):t._e(),t._v(" "),e.txt?a("p",[a("el-input",{staticClass:"mms-txt-preview",attrs:{value:e.txt,type:"textarea",readonly:"",resize:"none",autosize:""}})],1):t._e()])})],2)])])])]):t._e()]),t._v(" "),a("transition",{attrs:{name:"dialog-fade"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.dialogSent,expression:"dialogSent"}],staticClass:"dialog"},[a("div",{staticClass:"dialog-body"},[a("div",{staticClass:"dialog-header"},[t._v("\n          提交记录 "),a("i",{staticClass:"fr iconfont iconsystem-cancel-bold",on:{click:function(e){t.dialogSent=!1}}})]),t._v(" "),a("div",{staticClass:"dialog-content c p2"},[t.dialogSent?a("div",[a("sent-lists",{attrs:{id:t.id}})],1):t._e()])])])])],1)},staticRenderFns:[]},p=a("VU/8")(d,u,!1,null,null,null);e.default=p.exports}});